import React, { useEffect, useState } from 'react';
import { Document, Page as PdfPage, pdfjs } from 'react-pdf';
import 'react-pdf/dist/Page/TextLayer.css';
import 'react-pdf/dist/Page/AnnotationLayer.css';

import '@navikt/ds-css';
import '@navikt/ds-css';
import { CloudDownIcon } from '@navikt/aksel-icons';
import { Box, Button, HStack, Page, VStack } from '@navikt/ds-react';
import { Standarder } from './components/Standarder';
import type { Standarder as TypeStandarder } from './components/Standarder';

pdfjs.GlobalWorkerOptions.workerSrc = new URL(
  'pdfjs-dist/build/pdf.worker.min.mjs',
  import.meta.url
).toString();

export function PdfKvitteringViser() {
  const [pdfLenke, settPdfLenke] = useState<string | undefined>(undefined);
  const [antallSider, settAntallSider] = useState(0);
  const [sidetall, settSidetall] = useState(1);
  const [standarder] = useState<TypeStandarder | undefined>(undefined);

  function hexToBase64(hexString: string): string {
    // Remove the "0x" prefix if it exists
    if (hexString.startsWith('0x')) {
      hexString = hexString.slice(2);
    }
    // Convert the hex string into a byte array
    const byteArray = new Uint8Array(
      hexString.match(/.{1,2}/g)!.map((byte) => parseInt(byte, 16))
    );
    // Encode the byte array into a Base64 string
    return btoa(String.fromCharCode(...byteArray));
  }

  // Example usage
  const byteArrayString =
    '0xba4d5e07dedb961e3cd31c0adf0ec5358e3cfee9d47c3ca7e02680987c9dd51e00ff615e45b5fa8eeab9b4bd7dda987db9f69c21f96696fb770607be83546f59e4de45cd038d8d84cc487019ff4d9b93a7d92dc8194f5ee87b31772793342afc736148c714682a391a768457a9c70ec884eb1685eb29da20ffafc4dfcb465cf9f5d0972828eeafa1c49bec58f8c5b3a59c1e8b137eefef6c20e81bd5d4c61df4ac53a635e87c095346a9ff8b9fd994f346811c986c571225060222dd2ca88db48d337fa43bb289a4e1f6f7e23394215f68b5252cf1931c62fb834e5b09051623f856ffed7cb9940e0305f6be009fa9db2c40687588a59aad5e6bb4312959c5eaf2863688c824447ef496bb0cbd49278d737526b4487d8cc11e74a4a552d6e10b522af95a6d8bb97af00f97a635e1fe654469bd0d3910977815d664ee9ac53228cf54d3ebcca6a0b1ff76e0b41659c25a1454c3a55f99aa720688a2f6aaa1817ca4b8f529379e6aa8403fdf3219839dd63f8cced7a33593823f4af4419377eaabec941793a6c81d33fa27d1870a0f949cd1fd0c0d51e8fe7e4ac9edce80f905e518f929dc176752f786160641c6d71504b93b269444ad17aa6de8d4d71834f67ccaee06725d2e2c4d944d0c259e9c97617d006e160fc4f9d2ea867e0bfea2a2eec3023d330fa62c88feaae33014c5543fcb5bf415cf02de5161cfe6b307a8ff5790ee4ac31bd7c8361b4a837752933256e71f0c229e417a2795ddec613311913a5ee2e699a1133f482ca15db29e7490cc8915fefb7b8a3ecf706a46806c0070d16e2a355ddfd43f3b1da064ca0e6f576c7d3d58f8256e568bbcb70492bc9e157af94c2d246d38a57e0ad5db37e2ecb91824258a36837173324edc0b7582c85d0d83aa9555fec48adaa05c9163675fa1af810d16447b1a7d85ecee79bb6f147a52030dacb30326d285790aa8ebfff1c1616619dedad97d312f62ee1037a2a2b2f861830ee2fa81a9bdaa5f554e73aa98422c1c0a302c4f5e2ea9d010b4cb19210898ba21322930dd18c2f8c7e7f0e1ff5cbfd4e3fc52b86e208deae752edd299ff8da2e1fdd3e6f9f743ba5d147c1daf4a5b0dd0b9329151757bcefd153aa1c4e42d35d015d5e23a25d1a308bf72f28459faa98074334d6f405e3f393c2b43faf8d629c1ee8b2856511e80ce03bb928dec0c4d88f6b7b9a33f3be73ffc8babba013123a138bf7967b031df63e9bb4aee449345e76128c4b4068dddce9017ad7160c0138b46133736bda698d0444b8f000a537188c036a1d546871de80977325a800caad60c4bdb4995b8c93742415b88500187be90d2d468fda0f715186264ea4ac4dbd0fc129165ad0c51af210583bcfc202139a8c4828fdeac43c81956e1479fb180966f9a79767a1d167cf5373283f8a14216e38bc4cce7234b17d14e6f38169d47017d68df59e7f7d1828bda43f0b7524ff28ce280eecb3fd2e59266abd21c0c587152edff210f3a138b85d3280b07ca55a537c82b59117257225a5c550e608392d98de6c2cafac75103f6072d13c6958b421184950c2d1cf57263680c22425c36cf19e133acd01af1f4ffc8424c2461f08bc20273712d1cc83f9a6623d6edde8880d17705bf01f50e92ce27488b89a7781ea8c292b01309a5a55424bfe29f081db2f6c751dbfb960a1edc228bcebf5e0cd47820b4c57aaf732904615243f4e17a11d84c3dd292e467aef3a15e22e393fe3b4a91a0a4bdd1786c1ced27cc6cfab91be9bf9edab161ee08ad2624cf8343f4d926cef7bfeb3a74e90e2d3a1bbc64306a725138a4bcef0749410e5b250b8e231695e536abe97582a173758ef7d3075ef485aa322a13cd5c2b5bf7dc598dce956bb4e7995e5dea0b42d0f153067058408647a6a49c5512def2ca40c2f14fb3fc7ceee90b2b64ff11bbb2dad8678bf3a06797cb7ad551e9e56baf96c92c1e20b179542a4348c0f333411db8b31df6e50d55c787d770fcfd16dd48f71bec9a5b10dcf493e0ed4f071a24bc23248630a84b2c536beb8817eea2286ea8bd28d7902735396541ed74b4822c100f4cde4f217dabfce4e5d34834a0fff04460f999097ed42c71da99ff6050c1ea41c862973984e8bf38854d3db9681b7d46082959171dc7b066f7aef66ffbb27a47601587ecaadee82a70376ba9bf69c18c5f71d23a1318239fa6cc70daabbbf155e76303fa8aa905c44e4d4d8646df0fc91a0e29d03448eea2d58991b986710eb90417b88ecb42ccf6cd83e032be1fceb39dec9ae1870a759102e3fc664109babcab5ab23d30233c788eed66d398e30f60546d75d5b4cb810465119c7573699b80e87e1f231a1e5ec86f090a6e68a4cf79b55744c146c843ed96a473613d24f9496f754cb92b76ee80115de4acd3ec0980c59369715de75d2b1a572120f6381e53e01250dc48e90eef6e41d59c9a5345b2c39723c5154836f963fdf7e03d6a335d9ae1d40911cbe2d04b3daf53858ca10e8c12d52ba535474a2d070aca5e144e711366f344eb3ed6d8db601d428714eabfc5962d6082f771ef5c240258b367a0cf203066aa0bacb806fb5e5a5f2c078b4ad755e5b01df71946363abbf721e2e1ac24d0e6d012e2b7351570143ae61be08dfbf43e0a8e7ff251b5ec063c36cefa03b7d3947ab6d613dab95b2039af193002c1578a1b78f97d18e8fb147b6d73d9cbcb60f5787a40778c96208385a0b2a3961bb993e503e42a16e8ea07037db263d54519c3f687ddcf2e04d07fcd31dee27cf27dce0924f107f266916ec609984c7a0a88f123ad3d77578af15f58ad510983a098145e11a1d9767db608d118f7024d27f1d19f9541f70b5402d741a60457e4da7cb10e6ace8b872bc987fa1ca8abe78aa09704882ea274f86f5fe625c027058e02a9a4d6361d6c62c2bbe53e3c222a04e3813d37d6fd4ec5ef9afbbae511080f8b6fbb68c5914f616d3c32c2f476df5e4d16925d676ac702173258cc98c24650ee4feff4277a96a3756bfb9cec9229d4cc524e6cbb8ef331dabdaf1d9b155d657ed5526c310190d1eae0ee6746b15b3972d80a2beaa3f5f06f00fb7bc86a7ae113c3670a9fe5a424dbcdf4cbc7507ae06b3c5e6e7d821296651264f85c1d1537611caf866ce165ceeb39964619c489b94c9b7fd58c8af73a18b742f8a00d227674806ac1ae9c84c8fef7a62ad6a6610d6870d853bfba3a13b027705e0066409be0e6b843b4b70757a3cb18d7f0a1728535c008424e1afdfcd9d0138f0b88a212815fa8844d7519266c06ce2575553974df5c860572a7e1fff4cf38e3463b526e5f844d1ec1fe08d9de66af53f75dc47ef25efd3ff4f7536c877123ddcc35c8e93bc9dee9b17104602d1daa7aeb25c673aa1d8f4cc4747b4706cf38622150e08f0d29aeee04ec5482996a9de8bbbd339bd32a2020d53338c8f883afd8d7d9eb23c9eaa86939daa3f7d03978a4dd77168bd84a015301c545177adbd62fdea24d14d880e7f4ce56d9a73ea2b9468e81922c3a17c1aafab0a214f25c562f2352624dad65503f16a1903f5bd647a3290b92e61cad5f352890270545e19c577611bf528d0574632570d0c58238c5945d254e27bec22861f8223abdf0c554bc2221bca4d36441acd247b58db7b30a44e7f841b659b43e7a0436443c1e8bc4be40a756b5fd131ad1707cde4cd6c1f7cba8a8cb92f13edc9e9559dc48afad909f852a9f8748070f574c432a87f09c47535a33c23ed764025979390b1540993866336e92c4cec3f9b790aa89606e77ff02eac622f79b77521a8cd432efea5f363bfc576130525c20ac67ecd908b4766d967cbb266c3027414b9494937059f6a2d6561b1680c9e095c7e2cf94367000f3d3d5c61efc94807a7c961066b523267083e9016efa0cd70a05f1fd98b38c6b2eaec109c0568bc7151ccf97f6338b8bf1f40ff1c90b0986af09bbbfa5c828cc2906f2e3e790f891aa8208d83e433c3dd1a891a3fb1d606f35f33bfb88aab2f185050ded31f022afe1cfceabe48cbb8d4063254a1b859e5a0482253db9011b5d79d0bc168a03cd3848163eb10f59cc4478770ba89427cbe801cf2dd11810cfdb836713ae1ee2e91e3a7828030682752dd317cf07407a63ff7047f5bf0a6d82d60841fb9e43d4008f27d7308ef6226749a3da636b4ad56f802e9b1dabdbb31758d85c4b1971db1f20d6dc55272758837a2c4d18a98b5487eafd4b3a417aed71ec14f9410dc3c02e2ccd2145ba152da7d1d5cda36b88c5e7e5e1bba801b4c37a80b171cf3936c3853ec6a40bbc25789c7b71699b00569e8b05153c4df0e9852bea58d173b0f6cf35155f710ddcf3d404b72d723aa28be716b15e84cffa24df36975174c21138923d78552509c56d419269fedd264e4f517df673f0aa6eead9f2ff7db5bc3d9b6082df182481d7d02faf80b60acc4c300bd6a2fb8fe96d0866e782a0d3f267c9a23bd103c398f4e7dad9a2e49c62ef9a389b5fab106568195370e0bd13f487a536a0476ed89a21919a1ecff7d28a82709f9f7ac65d6f0a7d214d9d9e1c1c420cfd0cacec0c4b5c6f3ee7b6f184560711f3f4c8e71e6028726c4b288c16df100c5fd0d2dfc0aafe2785a6132954dd4f72e458e3a78c152da6bae8bd0f453b81cb7a071ae1c41b82b34e29363738c5214b2986277ff8f8b0976e17d97d2afd3e07ee5a374d4e58d827b0eca30f26ef78272940ce91b6369b4f639a42e6017c0463c2fbad65d723304f7268c2115e3c68dae8dc687e777501322acfceb3d1ad750bd67b10n';
  const hexString = byteArrayString;
  const base64String = hexToBase64(hexString);
  console.log(base64String);

  useEffect(() => {
    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
    // @ts-expect-error
    const lenkeKilde = `data:application/pdf;base64,${0x64f00ca293fa4512a0052241522c2d52b4fb9092d9234ee23494642f5de0c937fb9967919651f29f7e8a0f4bdad1c78fb2ed77ea61625afa16f9e81b4c11eb56511b56d9e81e36d87a0e9d9321b9aca86b20516dab12a2d675bfd44bb6b782bfea9eac9c1cefd1be6d12ef9b8b43feaa1592f115df9a390ccc6e3ab18591fe55b2858d6817fdb157d626d4443b294f9bb3ab8ab92d0b28ddcd11c351ef7caf0216d9e3dbba100fb1cb9543f4f48208deb60dfcdb07e2e3c1695a4960a783b7321d4e1b88675bcf4607af5f1e4f2b46f00fed031ce5788b9ad66a264b1d7cb07ffab65a84c5a4e0f3e2ee57d823fcf63f016773a8a5037dfa7e5443457de55f66afef28ba29efc90d976ceaabf445dc83574691b847707f24b97ad28162d563280b622875dc7b636aa6c1006a2518ee62bdd23f5c833258ca1cca7da18c4a7cc903db35019754d7f3eb7b1c79253cf2dbffd055bddba8b0986edb65867fda2556d12f0e414507575c869136552a2214ec4bfedbb30898c465548c41bfb1d1f24480b8fc19a33af80889fc1ddaab5372d110d01dd619e386b876f973f669820c49c473bedd9cb91d90129beadeb1f1ef60e87a9736c505e0636aa085b5f8d356724ebb8f68df9d3ad7c4b49c122686ba81dddaa9f510f4bf2267490b5cd4de38e861797bc2f399c3685b86c53a7b43e363c84416ed629d7372669296264ba0057456a7d42a4aa4a98c23f846c017433c926533a5bb10aee66998e99080cfac5ca54fc9a851ee48bed1a6b9e89655629d98356d127145cdf9217351f57a0f7e3afd95dc94735aedaa6740d65df9cf3aa18d9f52ec9c2f1fc8e1fbd952eec270c07605d8daf46e1700f0725b9b3c41d7ad58eb69f6582b239fbfd40333969bd81989cf5c3fccdccdab65b0db6c9f5de7a069491dae8d4b474c5d3e1c2eaac62ef15541e6014678784d3003e44a74234f1b7dfe8f6e0d9cc44a28b6998365268bda96723216f58addd7e2256c78c9dc1fd0454b0f96f6ec0b6f49440a3d9be90001906d2466d8a183f3043d1778918ec76090d703c96c3c863d06b560919cb193b2644d4a3cf0c0d5df354e617cace5cb3ea912ff422c8e42d13d178605ad93d3ad338461f0fe1d7099e55928593b5c08eecb37d419435c7d7abf0789d960664650fff07ff9c7df2a1017de1744310d88cda69496e993a1f4c32617e9566862f6f0b56db8d2852c0546849789e85a740c6855d918434c05f9be29ab18f605dd3cda94e336d05c51553aad9fdb4a53bf6b6ffd13c1c0c70e511c2fdcc464ecd0d2c86694d42b23a00067a6a38ce94467ab5e461085efe12de03fdb0c56fb37475b505e4c0bb92a52bb90dcf36ba0de90a61fc4fde27da4c9c16923afd712d3f3a956a987b4e2d4aa6edbc1ef2540d7355a6d7ca018b1a7f9a3a2969305ce37e4b8d515c6a2dd53bbe8d3a99c518e9b903ac58082574948bf7b52f62a2431387ce4860d2ef973a854c2d1a13d9893b9315b0210df2e8038d7bc8d08263a061b3fdfa650f47486ea8b984a4fa2c34dc1a33b972fc209f622bf068fdd1a03b8e7f29f0838930d3919353b37f38739bb3aa1174b1f7c361018cea523dc8946c2f1147aba94bb9905b3c9f278d9cd616bd04aadc4a319d0340fa862baf2a625aca0089758a0c152b89fff365ebec2d84cdc58eae763ced3c944df3da11219a57573c75e327dca4de1901930ec9369fd4393d83d62b5bba3a58bcebf45b417e53bc5f7fb3435fa01a6969b40724293f68b0c8d0d723099ad7a0b1b0e3ef4484d313bc1caed62d456fce0251ef66abe965500ec1ea73dab46b5eddd539767af1a23b3ba1f9f0808ed1428df375bc9dc09b6169234bbca468e1285b4c60e9b162539932723c6b2f3f7de1a0ae085a26b3f484021438f016c0e84eae51ee5a3334401060aba60a37d9ac4c1dcac5a5908c3a760007db09e7bfb730b231db2f5410c20518375982b20e6b599791ddece319c420df01b6a29b3defc2ef4cd2525b07851096a1664d3202eef3d1f86743543855aba5d6313bb766d6ea714e06e32af8b49839f8b42a4bd8f74713bec80c4a17d0905d323a074e0a120922f0c3532732de7ef428b834be5fcccfea111be54f5772b5b9d5a592fee817f914dd7d3da69ef492bfd613bd2c407067c13e28130e5673defd64856e5236e61d252288986d7fbcec6e41d0a721a89b0fe865a1358d1ca28548aead828d1496975abd8e19e4a711ecf04ca223aee1c6095aa60a428869dbb842fa7fd1c2c0522b3764d3afd90b30dc8e760a0b98efa95e98222fc7a06fd35b48a467cd1a09993d98027831a737816cc50e8dc7d736f3d553f70189654b2d54561ae46d377e814a007d11b595cd9f3c2b9719d73cc05470b17a292e87bd85c924dfd1cb1d6ed84a9a95ddca078464981126ba8df79d66cd91578b007c2f7d16c0d450e01906efb9bfd49bf8275352f6b4a6a59f7ab0e3a713f003bd3925e1a287153a7a6291191418a2c8761571466c8c3a013b34805334cb6ca6f70de0e37c13b76c49abc10abf132c8ed21e3119c55c189112d7a1023cbadedd09aaa42f6c622915318305fbcbf2540d918f324ea93e5f2069e6fd74a44bf1a55ef4491000f03bc2b8508a56629f4d6af5d9932b6eaa6fd72f79cd55b616cad291ef1e1c01c8af968665a6a9fe05997e5f1339fff65c6b728ad8494a8150002513b92e0d26fa45b13851ea7fe52cb70ec2802bcb11093dfcf239c5dd10cf45372666726d233fba5f1a5eeb22da3728e16ff2ff44c96aa2431be1daf668d252cca05167ff3f6265a49b544d102ad4f2e4a65d5cd22fe7f099ef9f4cb35f69dc773e714815ed6376686b0604ad50717d51bda152e44c3164630857324334221cc272e06d04a6a839896ef2c1c37ea7cc95b5b9d43fe776b6d8107762e588d61d5004b3c6a00b79ec5576a969dfe5fcb7eb76337e9c35ac61b0fbc9b882a2cf6a4bff464be01fdf9e634779a3afe7e822d0f629e09c14c714a300ea6de33b55c88d221a8c2f611e1bc58af3fbd583b18b2899f554bee5d0ef549c43db81542f2d1e11672dc97ca7e4f19a4ee0f10916547507c5a53b4b5a06acfd183315de444b1be08bfdfb139d318aab3247c965634365641b5475430001879ba7ee8e742708a165edd04d4421684bd9094d18959e4c03390b69c666b1284022572a212fce7039bd05be02b1c3879ba138c0b7bb29c6ef1ea28cddd05726349f81f33b6627db50e1d759236072aed81be3cae02b0872119b294bd2ac15043d6ec8a8a3c568d20e0d887aa01b22299c1ddb064497d771c7110cb8c7910687b0a41adc50b788da92f15c431318233e9ab55b410a59840e9be32f0b5d694398f49011a030f56b54d5554fbf7e58c062723f5e5874269a7752287ec67833ca70f11eda6c77c6aebdd7f54c72c53c042cb8a859bb22b87c62fce7ec1b838cefe0a69a8427a380bc82d51c6f7bfa13d921f559353b69549d915ae5c538367667dcfaeaef378c01f143e41d8dc54c96cc4022bb824b6fd44bf72faef7123ad622e2663f33ca0ea1c917d331345556ec72d68acbf43fedc9d5a9d3b3e019909351b8b4c29af83c3e445dc0deef1ba9b6a39904af1a04646d41e25ace3e08ea2098abe7bad0fa7d7e1056bc47746c2a68d265873bf916c630f76d05290249c86285f31ae1faacab45e6ef744f6a035fbd302c87e9148980a93bc2cfa782ed040c0867590dcf8aac2ac8af226476abee1f25060c025f7841dec8396f5d03364633665e1469ff17e96150916de2bdf8437530a69d1d15ea70de49d6006f91ee9cbf9ed0c4fe876ed970cb74d9a5db518672d72a5745ccf82b760e2d530c653a276f15e744078e2ac402e71c0a794fc89c7530e4621be201c187e88a866a9c75b83a60366aef0de0f46d15173d26193692cdabc8d5109e65a68904f4f668a7ae9b309ad2e90a756793dc14376a4c7615ec86dc92c2d4626bf56ed516848abaa2b9f769227feddce09f959effa0e13776295de833e612ad4ef5be44e866fce62ca90ef20b6a645093edd61d84cf56ea1e0da33a6eee2b56c4c7635d4d2f94a06df0b3e29597e46aa36692d1cd76fb9f1e791f0c370a31c7652de2911417701d2e0310865a73bc8f3cb55a576550d93fe67243a8bcab6c0e44f83038a6a9e6e4234ac4bf6641e1f0bf60707aa871fa99e556eded25d943cc5a82e44a54eb4f64a094117b2548edc49ab63c33449c4b414a3acaab579c27a0d68672d1ff0e8e8561d68ce15ee42255232ea958038cfe5c1cf19d782f5056af72a14f2ec3e0190e2a32c4dc9cb3994538f013f84f5c9fb81721f17082f10c2f3c129a0a9d0cbe2ded3a8c5bfccf5ad1c03c970867835966b8ab7f3b60ff8954b6ddaec338473c6b17eeb80503046557194c380f45ca3cf7f9c0f3f2d47ecb74aab830bdf5b4e633d63cce2c49212105e7f2ba8461c5a4d1ffdfbf00908af7eb799f49dd286cee497b82cdc590eb7fd6c17facaca31cd2e65b63810f559014fef60aa573479647a9cf5cad7f90d2173443611a032fc04ba90dc2946c43ff85962ebde39ca8ece28acf20078129ae7523d20e9e0bf5f4d3630a78917bf0564c0d28731ed96894ffeaaa4af2a105183f39ecb69fa872be304c58b1dd56227750c4ee3b5002c7e74495b93661f2c46acc2ebc197e67a94faf92858dd0cf449e2a639cf6e1b361362cbe560ae6329735d4fecb50dcd941e5b63b06929a68e7d6ddd5773b794775b96292f7db6f180ab3e5cn}`;
    settPdfLenke(lenkeKilde);
  }, []);

  return (
    <Page className="bg-blue-100">
      {pdfLenke && (
        <>
          <HStack margin={'2'} gap={'10'}>
            <Box className="mr-8 overflow-auto w-fit max-w-[60%]">
              <Document
                file={pdfLenke}
                onLoadSuccess={({ numPages }) => settAntallSider(numPages)}
              >
                <PdfPage pageNumber={sidetall}></PdfPage>
              </Document>
            </Box>

            <VStack gap={'3'}>
              <HStack justify={'space-between'}>
                <VStack>
                  <p>
                    Side {sidetall} av {antallSider}
                  </p>

                  <HStack gap={'4'}>
                    <Button
                      disabled={sidetall === 1}
                      onClick={() => settSidetall(sidetall - 1)}
                    >
                      Forrige
                    </Button>
                    f
                    <Button
                      disabled={sidetall === antallSider}
                      onClick={() => settSidetall(sidetall + 1)}
                    >
                      Neste
                    </Button>
                    <Button icon={<CloudDownIcon aria-hidden />}>
                      Last ned Pdf
                    </Button>
                  </HStack>
                </VStack>
              </HStack>
              {standarder && <Standarder standarder={standarder} />}
            </VStack>
          </HStack>
        </>
      )}
    </Page>
  );
}
